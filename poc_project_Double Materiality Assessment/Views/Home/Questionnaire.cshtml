@model poc_project_Double_Materiality_Assessment.Models.ViewModels.DoubleMaterialityViewModel
@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor

@{
    var organization = HttpContextAccessor.HttpContext.Session.GetString("Organization");
}


<h2>Double Materiality Questionnaire</h2>

<form method="post" asp-action="QuestionnaireSubmit">
    <h4>Personal Information</h4>
    <div class="stakeholderInfo contentSection">
        <label asp-for="Stakeholder.Name"></label>
        <input type="text" asp-for="Stakeholder.Name" required />

        <label asp-for="Stakeholder.Organization"></label>
        <input type="text" asp-for="Stakeholder.Organization" value="@organization" required />

        <label asp-for="Stakeholder.Role"></label>
        <input type="text" asp-for="Stakeholder.Role" required />

        <label asp-for="Stakeholder.Category"></label>
        <input type="text" asp-for="Stakeholder.Category" required />
    </div>

    <h4>Issues</h4>
    <div class="issues contentSection">
        @for (int index = 0; index < Model.MaterialIssues.Count; index++)
        {
            var issue = Model.MaterialIssues[index];
            var response = Model.Responses[index];

            <div class="issue-container">
                <label>@issue.IssueName</label>
                <div class="radio-group">
                    @for (int i = 1; i <= 5; i++)
                    {
                        <input type="radio" id="issueRelevance_@issue.MaterialIssueId-@i"
                               asp-for="Responses[@index].RelevanceScore"
                               value="@i" />
                        <label for="issueRelevance_@issue.MaterialIssueId-@i">@i</label>
                    }
                </div>
                <textarea asp-for="Responses[@index].Comments"
                          rows="3" placeholder="Add your comments here..."></textarea>
                <input type="hidden" asp-for="Responses[@index].IssueId"
                       value="@issue.MaterialIssueId" />
            </div>
        }
    </div>

    <button type="submit">Submit</button>
    <button type="button" onclick="saveForLater()">Save for Later</button>
</form>

<link href="~/css/questionnaire.css" rel="stylesheet" type="text/css" asp-append-version="true" />